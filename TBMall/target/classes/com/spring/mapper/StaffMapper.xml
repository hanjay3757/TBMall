<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.mapper.StaffMapper">
	<!-- resultType 에 복수형(ArrayList 등)을 적는게 아님. 
	그냥 dto 단수의 경로를 적어야됨. -->
	<select id="getList" resultType="com.spring.dto.StaffDto">
		SELECT * FROM tbmall_member 
		ORDER BY member_no DESC
	</select>
	
	<select id="read" resultType="com.spring.dto.StaffDto">
	select * from tbmall_member where member_no = #{member_no}
	</select>
	<!-- 관리자 임명 삭제권한 x-->
	<insert id="adminAppoint">
		INSERT INTO tbmall_admin (member_no, delete_right_no) values (#{member_no},0)
	</insert>
	
	<!-- 삭제 권한 부여 -->
	<update id="softDelete">
	UPDATE tbmall_admin SET delete_right_no = 1
	where member_no = #{member_no}
	</update>
	<!-- 삭제 권한 회수 -->
	<update id="restore">
	UPDATE tbmall_admin SET delete_right_no = 0
	where member_no = #{member_no}
	</update>
	<!-- 삭제 권한 가진 admin 호출 -->
	<select id="getDeletedStaff" resultType="com.spring.dto.StaffDto">
	 SELECT tbmall_admin.admin_no,tbmall_member.member_no, tbmall_member.member_nick
        FROM tbmall_admin
        JOIN tbmall_member
        ON tbmall_admin.member_no= tbmall_member.member_no
        WHERE tbmall_admin.delete_right_no =1
	</select>
	<!-- 로그인 -->
	<select id="login" resultType="com.spring.dto.StaffDto">
		SELECT * FROM tbmall_member 
		WHERE member_id = #{member_id} AND member_pw = #{member_pw}
	</select>
	<!-- 계정정보 수정 인듯? -->
	<update id="update" parameterType="com.spring.dto.StaffDto">
    UPDATE tbmall_member 
    SET 
        member_nick = #{member_nick},
        member_pw = #{member_pw},
        member_phone = #{member_phone}
        member_email =#{member_email}
    WHERE member_no = #{member_no}
</update>
</mapper>